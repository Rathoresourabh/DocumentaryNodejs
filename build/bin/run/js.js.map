{"version":3,"sources":["../../../src/bin/run/js.js"],"names":["runJs","config","source","generateTo","stream","st","console","log","process","exit","s","rs","pipe","p","error","err"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;AAMA,eAAeA,KAAf,CAAqBC,MAArB,EAA6B;AAC3B,QAAM;AACJC,UADI;AAEJC,iBAAaD,MAFT;AAGJE,YAAQC;AAHJ,MAIFJ,MAJJ;;AAKA,MAAI;AACF,QAAI,CAACC,MAAD,IAAW,CAACG,EAAhB,EAAoB;AAClBC,cAAQC,GAAR,CAAY,sDAAZ;AACAC,cAAQC,IAAR,CAAa,CAAb;AACD;;AAED,UAAMC,IAAI,0BAAiBR,MAAjB,CAAV;AACA,UAAMS,KAAK,+BAAX;AACAD,MAAEE,IAAF,CAAOD,EAAP;AAEA,UAAM;AAAEE;AAAF,QAAQ,0BAAYF,EAAZ,EAAgBN,EAAhB,EAAoBF,UAApB,CAAd;AACA,UAAMU,CAAN;AAEAP,YAAQQ,KAAR,CAAc,IAAIZ,UAAUC,UAAV,GAAuB,CAAC,8BAAD,EAAiCD,MAAjC,CAAvB,GAAkE,CAAC,oBAAD,EAAuBC,UAAvB,CAAtE,CAAd;AACD,GAdD,CAcE,OAAOY,GAAP,EAAY;AACZ,0BAAQA,GAAR;AACD;AACF;AAED;;;;;;;eAMef,K","sourcesContent":["import { createReadStream } from 'fs'\nimport createJsReplaceStream from '../../lib/js-replace-stream'\nimport catcher from '../catcher'\nimport whichStream from './which-stream'\n\n/**\n * Process a JavaScript file to include `@typedef`s found with the `/* documentary types.xml *\\/` marker.\n * @param {Config} config Configuration Object.\n * @param {string} config.source Path to the source JavaScript file.\n * @param {string} [config.output] Path to the source JavaScript file.\n */\nasync function runJs(config) {\n  const {\n    source,\n    generateTo = source,\n    stream: st,\n  } = config\n  try {\n    if (!source && !st) {\n      console.log('Please specify a JavaScript file or a pass a stream.')\n      process.exit(1)\n    }\n\n    const s = createReadStream(source)\n    const rs = createJsReplaceStream()\n    s.pipe(rs)\n\n    const { p } = whichStream(rs, st, generateTo)\n    await p\n\n    console.error(...(source == generateTo ? ['Updated %s to include types.', source] : ['Saved output to %s', generateTo]))\n  } catch (err) {\n    catcher(err)\n  }\n}\n\n/**\n * @typedef {Object} Config\n * @prop {string} source Path to the source JavaScript file.\n * @prop {string} [output] Path to the source JavaScript file.\n */\n\nexport default runJs\n"],"file":"js.js"}