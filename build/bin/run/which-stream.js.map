{"version":3,"sources":["../../../src/bin/run/which-stream.js"],"names":["whichStream","source","readable","stream","destination","pipe","Promise","r","j","once","process","stdout","promise","Catchment","rs","res","ws","end","on"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,eAAeA,WAAf,CAA2B;AACzBC,QADyB;AAEzBC,UAFyB;AAGzBC,QAHyB;AAIzBC;AAJyB,CAA3B,EAKG;AACD,MAAID,MAAJ,EAAY;AACVD,aAASG,IAAT,CAAcF,MAAd,EADU,CACY;;AACtB,UAAM,IAAIG,OAAJ,CAAY,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC1BL,aAAOM,IAAP,CAAY,OAAZ,EAAqBD,CAArB,EAAwBC,IAAxB,CAA6B,KAA7B,EAAoCF,CAApC;AACD,KAFK,CAAN;AAGD,GALD,MAKO,IAAIH,eAAe,GAAnB,EAAwB;AAAE;AAC/BF,aAASG,IAAT,CAAcK,QAAQC,MAAtB;AACD,GAFM,MAEA,IAAIV,UAAUG,WAAd,EAA2B;AAAE;AAClC,UAAM;AAAEQ;AAAF,QAAc,IAAIC,kBAAJ,CAAc;AAAEC,UAAIZ;AAAN,KAAd,CAApB;AACA,UAAMa,MAAM,MAAMH,OAAlB;AACA,UAAMI,KAAK,2BAAkBZ,WAAlB,CAAX;AACA,UAAM,IAAIE,OAAJ,CAAY,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC1BQ,SAAGP,IAAH,CAAQ,OAAR,EAAiBD,CAAjB,EAAoBS,GAApB,CAAwBF,GAAxB,EAA6BR,CAA7B;AACD,KAFK,CAAN;AAGD,GAPM,MAOA;AACL,UAAMS,KAAK,2BAAkBZ,WAAlB,CAAX;AACAF,aAASG,IAAT,CAAcW,EAAd;AACA,UAAM,IAAIV,OAAJ,CAAY,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC1BQ,SAAGE,EAAH,CAAM,OAAN,EAAeV,CAAf,EAAkBU,EAAlB,CAAqB,OAArB,EAA8BX,CAA9B;AACD,KAFK,CAAN;AAGD;AACF;;eAEcP,W","sourcesContent":["import Catchment from 'catchment'\nimport { createWriteStream } from 'fs'\n\nasync function whichStream({\n  source,\n  readable,\n  stream,\n  destination,\n}) {\n  if (stream) {\n    readable.pipe(stream) // push to stream\n    await new Promise((r, j) => {\n      stream.once('error', j).once('end', r)\n    })\n  } else if (destination == '-') { // printing to stdout\n    readable.pipe(process.stdout)\n  } else if (source == destination) { // overwriting file\n    const { promise } = new Catchment({ rs: readable })\n    const res = await promise\n    const ws = createWriteStream(destination)\n    await new Promise((r, j) => {\n      ws.once('error', j).end(res, r)\n    })\n  } else {\n    const ws = createWriteStream(destination)\n    readable.pipe(ws)\n    await new Promise((r, j) => {\n      ws.on('error', j).on('close', r)\n    })\n  }\n}\n\nexport default whichStream\n"],"file":"which-stream.js"}